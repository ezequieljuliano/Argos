<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui" xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets" template="/template/main.xhtml">

    <ui:define name="body">
        <style type="text/css">
            .linha-pesquisa .nome-link {
                padding: 0px;
                margin: 0px;
                margin-bottom: 5px;
                font-size: medium;
            }
            .linha-pesquisa .nome-link a{
                color: #12C;
            }

            .linha-pesquisa .nome-link span {
                display: inline-block;
                text-indent: -999999px;
                overflow: hidden;
                width: 16px;
                height: 16px;
                margin-right: 5px;
            }
            .linha-pesquisa p {
                font-size: small;
                margin: 0px;
                margin-bottom: 3px;
            }
            .linha-pesquisa {
                padding: 5px;
                font-family: arial, sans-serif;
                margin-bottom: 10px;
                padding-bottom: 5px;
                color: #222;
                border-bottom: 1px solid #ddd;
            }
            .linha-pesquisa:hover {
                background-color: #f6f6f6;
            }
            .nivel1 {
                background-image: url(images/info.png);
            }
            .nivel2 {
                background-image: url(images/alerta.png);
            }
            .nivel3 {
                background-image: url(images/erro.png);
            }
            .nivel4 {
                background-image: url(images/critico.png);
            }
        </style>
        <h:form id="frm" rendered="#{securityContext.hasRole('N')}">

            <p:toolbar>
                <p:toolbarGroup rendered="#{eventoPesquisaMB.pesquisaAvancada == false}">
                    <h:panelGrid columns="3">
                        <p:inputText value="#{eventoPesquisaMB.campoPesquisa}" size="40"/>

                        <p:selectOneMenu value="#{eventoPesquisaMB.tipoPesquisa}">  
                            <f:selectItems value="#{eventoPesquisaMB.tipoPesquisas}"/>
                        </p:selectOneMenu>  

                        <p:commandButton value="Pesquisar" action="#{eventoPesquisaMB.pesquisar()}" image="ui-icon ui-icon-circle-zoomin" update="frm"/>
                    </h:panelGrid>
                </p:toolbarGroup>

            </p:toolbar>

            <br />

            <p:dialog width="800" height="500" showHeader="false" widgetVar="dlgEvento" modal="true" closable="true">
                <h:panelGroup layout="block" id="pEvento">  
                    <p:fieldset legend="#{eventoPesquisaMB.evento.nome}">

                        <h:outputText value="Data: "/>
                        <h:outputText value="#{eventoPesquisaMB.evento.ocorrenciaData}">
                            <f:convertDateTime type="date" pattern="dd/MM/yyyy" timeZone="GMT-03:00"/>
                        </h:outputText> 
                        <h:outputText value=" - "/>
                        <h:outputText value="Hora: "/>
                        <h:outputText value="#{eventoPesquisaMB.evento.ocorrenciaHora}">
                            <f:convertDateTime type="time" pattern="HH:mm:ss" timeZone="GMT-03:00"/>
                        </h:outputText>
                        <br />
                        <h:outputText value="Usuário: "/>
                        <h:outputText value="#{eventoPesquisaMB.evento.usuarioGerador}"/>
                        <h:outputText value=" - "/>
                        <h:outputText value="IP: "/>
                        <h:outputText value="#{eventoPesquisaMB.evento.enderecoIp}"/>
                        <h:outputText value=" - "/>
                        <h:outputText value="Computador: "/>
                        <h:outputText value="#{eventoPesquisaMB.evento.computadorGerador}"/>
                        <br />
                        <h:outputText value="Fonte: "/>
                        <h:outputText value="#{eventoPesquisaMB.evento.fonte}"/>
                        <h:outputText value=" - "/>
                        <h:outputText value="Tipo: "/>
                        <h:outputText value="#{eventoPesquisaMB.evento.eventoTipo.descricao}"/>
                        <h:outputText value=" - "/>
                        <h:outputText value="Nível: "/>
                        <h:outputText value="#{eventoPesquisaMB.evento.eventoNivel.descricao}"/>
                        <br />
                        <h:outputText value="Palavras-Chave: "/>
                        <h:outputText value="#{eventoPesquisaMB.evento.palavrasChave}"/>
                        <br />
                        <h:outputText value="Entidade: "/>
                        <h:outputText value="#{eventoPesquisaMB.evento.entidade.codigo}"/>
                        <h:outputText value=" - "/>
                        <h:outputText value="#{eventoPesquisaMB.evento.entidade.cadastroNacional}"/>
                        <h:outputText value=" - "/>
                        <h:outputText value="#{eventoPesquisaMB.evento.entidade.nome}"/>
                        <br />
                        <br />
                        <h:outputText value="Descrição: "/>
                        <br />
                        <h:outputText value="#{eventoPesquisaMB.evento.descricao}"/>

                    </p:fieldset>
                </h:panelGroup>  
                <f:facet name="footer">
                    <p:commandButton value="Fechar" onclick="dlgEvento.hide()" image="ui-icon ui-icon-arrowreturn-1-w"  style="float: right;" update="frm"/>
                </f:facet>
            </p:dialog>

            <p:fieldset legend="Lista de Eventos (Logs)">
                <ui:repeat value="#{eventoPesquisaMB.eventos}" var="bean">
                    <div class="linha-pesquisa">
                        <h3 class="nome-link">
                            <span class="nivel#{bean.eventoNivel.codigo}">#{bean.eventoNivel.codigo}</span>

                            <p:commandLink onclick="dlgEvento.show()" update=":frm:pEvento">
                                <h:outputText value="#{bean.nome}"/>
                                <f:setPropertyActionListener target="#{eventoPesquisaMB.evento}" value="#{bean}"/> 
                            </p:commandLink>

                        </h3>
                        <p>
                            <b>Data: </b>
                            <h:outputText value="#{bean.ocorrenciaData}">
                                <f:convertDateTime type="date" pattern="dd/MM/yyyy" timeZone="GMT-03:00"/>
                            </h:outputText> 
                            <b>Hora: </b>
                            <h:outputText value="#{bean.ocorrenciaHora}">
                                <f:convertDateTime type="time" pattern="HH:mm:ss" timeZone="GMT-03:00"/>
                            </h:outputText>
                            <b>Usuário: </b>
                            <h:outputText value="#{bean.usuarioGerador}"/>
                            <b>IP: </b>
                            <h:outputText value="#{bean.enderecoIp}"/>
                            <b>PC: </b>
                            <h:outputText value="#{bean.computadorGerador}"/>
                        </p>
                        <p>
                            <b>Fonte: </b>
                            <h:outputText value="#{bean.fonte}"/>
                            <b>Tipo de Evento: </b>
                            <h:outputText value="#{bean.eventoTipo.descricao}"/>
                            <b>Nível de Evento: </b>
                            <h:outputText value="#{bean.eventoNivel.descricao}"/>
                        </p>
                        <p>
                            <b>Palavras-Chave: </b>
                            <h:outputText value="#{bean.palavrasChave}"/> 
                        </p>
                        <p>
                            <b>Entidade: </b>
                            <h:outputText value="#{bean.entidade.cadastroNacional}"/> -  
                            <h:outputText value="#{bean.entidade.nome}"/> 
                        </p>
                    </div>
                </ui:repeat>
            </p:fieldset>

        </h:form>
    </ui:define>

</ui:composition>